{"ast":null,"code":"import Axios from \"axios\";\n\nasync function login(email, pwd) {\n  const res = await Axios.post(\"/api/login\", {\n    email,\n    pwd\n  });\n  const {\n    data\n  } = await res;\n\n  if (data.error) {\n    return data.error;\n  } else {\n    localStorage.setItem(\"token\", data.token);\n    localStorage.setItem(\"refreshToken\", data.refreshToken);\n    return true;\n  }\n}\n\nasync function check() {\n  const token = localStorage.getItem(\"token\");\n\n  try {\n    const res = await Axios.post(\"/api/checkiftokenexpire\", {}, {\n      headers: {\n        Authorization: \"Bearer \" + token\n      }\n    });\n    const {\n      data\n    } = await res;\n    return data.success;\n  } catch {\n    console.log(\"p\");\n    const refresh_token = localStorage.getItem(\"refreshToken\");\n\n    if (!refresh_token) {\n      localStorage.removeItem(\"token\");\n      return false;\n    }\n\n    Axios.post(\"/api/refreshtoken\", {}, {\n      headers: {\n        Authorization: `Bearer ${refresh_token}`\n      }\n    }).then(res => {\n      localStorage.setItem(\"token\", res.data.token);\n    });\n    return true;\n  }\n}\n\nfunction logout() {\n  if (localStorage.getItem(\"token\")) {\n    const token = localStorage.getItem(\"token\");\n    Axios.post(\"/api/logout/access\", {}, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }).then(res => {\n      if (res.data.error) {\n        console.error(res.data.error);\n      } else {\n        localStorage.removeItem(\"token\");\n      }\n    });\n  }\n\n  if (localStorage.getItem(\"refreshToken\")) {\n    const refreshToken = localStorage.getItem(\"refreshToken\");\n    Axios.post(\"/api/logout/refresh\", {}, {\n      headers: {\n        Authorization: `Bearer ${refreshToken}`\n      }\n    }).then(res => {\n      if (res.data.error) {\n        console.error(res.data.error);\n      } else {\n        localStorage.removeItem(\"refreshToken\");\n      }\n    });\n  }\n\n  localStorage.clear();\n  setTimeout(() => window.location = \"/\", 500);\n}\n\nexport { login, check, logout };","map":{"version":3,"names":["Axios","login","email","pwd","res","post","data","error","localStorage","setItem","token","refreshToken","check","getItem","headers","Authorization","success","console","log","refresh_token","removeItem","then","logout","clear","setTimeout","window","location"],"sources":["C:/Users/yc_19/OneDrive/Documents/TechTrek/frontend/src/login.js"],"sourcesContent":["import Axios from \"axios\";\r\n\r\nasync function login(email, pwd) {\r\n  const res = await Axios.post(\"/api/login\", { email, pwd });\r\n  const { data } = await res;\r\n  if (data.error) {\r\n    return data.error;\r\n  } else {\r\n    localStorage.setItem(\"token\", data.token);\r\n    localStorage.setItem(\"refreshToken\", data.refreshToken);\r\n    return true;\r\n  }\r\n}\r\n\r\nasync function check() {\r\n  const token = localStorage.getItem(\"token\");\r\n  try {\r\n    const res = await Axios.post(\r\n      \"/api/checkiftokenexpire\",\r\n      {},\r\n      {\r\n        headers: {\r\n          Authorization: \"Bearer \" + token,\r\n        },\r\n      }\r\n    );\r\n    const { data } = await res;\r\n    return data.success;\r\n  } catch {\r\n    console.log(\"p\");\r\n    const refresh_token = localStorage.getItem(\"refreshToken\");\r\n    if (!refresh_token) {\r\n      localStorage.removeItem(\"token\");\r\n      return false;\r\n    }\r\n    Axios.post(\r\n      \"/api/refreshtoken\",\r\n      {},\r\n      {\r\n        headers: {\r\n          Authorization: `Bearer ${refresh_token}`,\r\n        },\r\n      }\r\n    ).then((res) => {\r\n      localStorage.setItem(\"token\", res.data.token);\r\n    });\r\n    return true;\r\n  }\r\n}\r\n\r\nfunction logout() {\r\n  if (localStorage.getItem(\"token\")) {\r\n    const token = localStorage.getItem(\"token\");\r\n    Axios.post(\r\n      \"/api/logout/access\",\r\n      {},\r\n      {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      }\r\n    ).then((res) => {\r\n      if (res.data.error) {\r\n        console.error(res.data.error);\r\n      } else {\r\n        localStorage.removeItem(\"token\");\r\n      }\r\n    });\r\n  }\r\n  if (localStorage.getItem(\"refreshToken\")) {\r\n    const refreshToken = localStorage.getItem(\"refreshToken\");\r\n    Axios.post(\r\n      \"/api/logout/refresh\",\r\n      {},\r\n      {\r\n        headers: {\r\n          Authorization: `Bearer ${refreshToken}`,\r\n        },\r\n      }\r\n    ).then((res) => {\r\n      if (res.data.error) {\r\n        console.error(res.data.error);\r\n      } else {\r\n        localStorage.removeItem(\"refreshToken\");\r\n      }\r\n    });\r\n  }\r\n  localStorage.clear();\r\n  setTimeout(() => (window.location = \"/\"), 500);\r\n}\r\n\r\nexport { login, check, logout };\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}